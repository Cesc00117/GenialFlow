ind_dif <- diff(ind_growth)
dat[,1] <- as.Date(dat[,1])
ind_ln <- log(ind_growth)
ind_dif <- diff(ind_growth)
lnind_dif <- diff(ind_ln)
df <- as.data.frame(cbind(time, lnind_dif),
stringsAsFactors = F)
df[,2] <- as.numeric(df[,2])
x <- df[36:335, 2]
adf.test(x)
draw <- seq(from=3, to=length(x), by=3)
indgrowth <- (x[draw-2]*0.33+x[draw-1]*0.33+x[draw])*0.33
df <- uniModel('ROE/计算机ROE.csv', indgrowth)
setwd('E:/github/respository/GenialFlow')
library('vars')   # 程序包：向量自回归
library('lmtest') # 程序包： 时间序列检验
uniModel <- function(filename, indgrowth){
idx <- getIndex(filename)
fit <- cbind(idx, indgrowth)
# 对NA进行插补）
fit <- fit[7:nrow(fit),] # 弃掉NA出现概率较高的前几年
if(is.na(fit[1,1])) fit[1,1] <- fit[2,1]
na <- which(is.na(fit[,1]))
fit[,1][na] <- (fit[,1][na+1]+fit[,1][na-1])/2 # 上下平均值插补NA
print('行业指标的平稳性检验结果:')
print(adf.test(fit[,1]))
colnames(fit) <- c('index', 'growth')
return(fit)
}
df <- uniModel('ROE/计算机ROE.csv', indgrowth)
df <- uniModel('ROE/采掘ROE.csv', indgrowth)
View(aa)
aa <- getIndex('ROE/钢铁ROE.csv')
View(aa)
? na.fill
na.fill(aa,0)
View(aa)
idxMedian <- function(df, time_start, time_end){
num <- df[,4:ncol(df)]
for(i in 1:ncol(num)) num[,i] <- as.numeric(num[,i])
num <- na.fill(num, 0)
# 提取指标
idx <- c()
for(i in 1:ncol(num)){
m <- num[,i]
m[which(m==0)]<-NA
mid <- median(m, na.rm = T)
idx <- c(idx, mid)
}
idx <- as.numeric(idx)
rlt <- as.data.frame(idx,
row.names =
as.character(
seq.Date(
from = as.Date(time_start),
to = as.Date(time_end),
by = 'quarter')))
return(rlt)
}
getIndex <- function(filename){
path <- paste('AshareIndustry/', filename, sep = '')
profit <- read.csv(path, header = T)
idx <- idxMedian(df = profit,
time_start = "1993/3/1",
time_end = "2017/12/1")
return(idx)
}
aa <- getIndex('ROE/钢铁ROE.csv')
View(aa)
aa <- read.csv('ROE/钢铁ROE.csv')
aa <- read.csv('AshareIndustry/ROE/钢铁ROE.csv')
View(aa)
bb <- read.csv('AshareIndustry/净利润同比增长/
钢铁净利润.csv')
aa <- read.csv('AshareIndustry/ROE/钢铁ROE.csv')
bb <- read.csv('AshareIndustry/净利润同比增长/钢铁净利润.csv')
View(bb)
View(aa)
View(bb)
aa[,104]
setwd('E:/github/respository/GenialFlow/AshareIndustry')
hangye <- read.csv('上市公司行业.csv', header = T, stringsAsFactors = F)
roe <- read.csv('ROE/ROE.csv', header = T, stringsAsFactors = F)
dat <- merge(roe, hangye, by.x='证券代码',
by.y='上市公司')
dat[,2]<-dat[,103]
dat <- dat[,1:102]
colnames(dat)[2] <- '申万一级行业'
setwd('E:/github/respository/GenialFlow/AshareIndustry/ROE')
write.csv(dat[which(dat[,2] == '采掘'),], file = '采掘ROE.csv')
write.csv(dat[which(dat[,2] == '传媒'),], file = '传媒ROE.csv')
write.csv(dat[which(dat[,2] == '电气设备'),], file = '电气设备ROE.csv')
write.csv(dat[which(dat[,2] == '电子'),], file = '电子ROE.csv')
write.csv(dat[which(dat[,2] == '房地产'),], file = '房地产ROE.csv')
write.csv(dat[which(dat[,2] == '纺织服装'),], file = '纺织服装ROE.csv')
write.csv(dat[which(dat[,2] == '非银金融'),], file = '非银金融ROE.csv')
write.csv(dat[which(dat[,2] == '钢铁'),], file = '钢铁ROE.csv')
write.csv(dat[which(dat[,2] == '公用事业'),], file = '公用事业ROE.csv')
write.csv(dat[which(dat[,2] == '国防军工'),], file = '国防军工ROE.csv')
write.csv(dat[which(dat[,2] == '化工'),], file = '化工ROE.csv')
write.csv(dat[which(dat[,2] == '机械设备'),], file = '机械设备ROE.csv')
write.csv(dat[which(dat[,2] == '计算机'),], file = '计算机ROE.csv')
write.csv(dat[which(dat[,2] == '家用电器'),], file = '家用电器ROE.csv')
write.csv(dat[which(dat[,2] == '建筑材料'),], file = '建筑材料ROE.csv')
write.csv(dat[which(dat[,2] == '建筑装饰'),], file = '建筑装饰ROE.csv')
write.csv(dat[which(dat[,2] == '交通运输'),], file = '交通运输ROE.csv')
write.csv(dat[which(dat[,2] == '农林牧渔'),], file = '农林牧渔ROE.csv')
write.csv(dat[which(dat[,2] == '汽车'),], file = '汽车ROE.csv')
write.csv(dat[which(dat[,2] == '轻工制造'),], file = '轻工制造ROE.csv')
write.csv(dat[which(dat[,2] == '商业贸易'),], file = '商业贸易ROE.csv')
write.csv(dat[which(dat[,2] == '食品饮料'),], file = '食品饮料ROE.csv')
write.csv(dat[which(dat[,2] == '通信'),], file = '通信ROE.csv')
write.csv(dat[which(dat[,2] == '休闲服务'),], file = '休闲服务ROE.csv')
write.csv(dat[which(dat[,2] == '医药生物'),], file = '医药生物ROE.csv')
write.csv(dat[which(dat[,2] == '银行'),], file = '银行ROE.csv')
write.csv(dat[which(dat[,2] == '有色金属'),], file = '有色金属ROE.csv')
write.csv(dat[which(dat[,2] == '综合'),], file = '综合ROE.csv')
setwd('E:/github/respository/GenialFlow')
idxMedian <- function(df, time_start, time_end){
num <- df[,4:ncol(df)]
for(i in 1:ncol(num)) num[,i] <- as.numeric(num[,i])
num <- na.fill(num, 0)
# 提取指标
idx <- c()
for(i in 1:ncol(num)){
m <- num[,i]
m[which(m==0)]<-NA
mid <- median(m, na.rm = T)
idx <- c(idx, mid)
}
idx <- as.numeric(idx)
rlt <- as.data.frame(idx,
row.names =
as.character(
seq.Date(
from = as.Date(time_start),
to = as.Date(time_end),
by = 'quarter')))
return(rlt)
}
getIndex <- function(filename){
path <- paste('AshareIndustry/', filename, sep = '')
profit <- read.csv(path, header = T)
idx <- idxMedian(df = profit,
time_start = "1993/3/1",
time_end = "2017/12/1")
return(idx)
}
aa <- getIndex('ROE/钢铁ROE.csv')
View(aa)
setwd('E:/github/respository/GenialFlow')
dat <- read.csv('economicData/indGrowth.csv', header = T, stringsAsFactors = F)
library('tseries') #载入tseries包
ind_growth <- dat[,2]
time <- dat[,1][2:nrow(dat)]
ind_dif <- diff(ind_growth)
dat[,1] <- as.Date(dat[,1])
ind_ln <- log(ind_growth)
ind_dif <- diff(ind_growth)
lnind_dif <- diff(ind_ln)
df <- as.data.frame(cbind(time, lnind_dif),
stringsAsFactors = F)
df[,2] <- as.numeric(df[,2])
x <- df[36:335, 2]
adf.test(x)
draw <- seq(from=3, to=length(x), by=3)
indgrowth <- (x[draw-2]*0.33+x[draw-1]*0.33+x[draw])*0.33
uniModel <- function(filename, indgrowth){
idx <- getIndex(filename)
fit <- cbind(idx, indgrowth)
# 对NA进行插补）
fit <- fit[5:nrow(fit),] # 弃掉NA出现概率较高的前几年
if(is.na(fit[1,1])) fit[1,1] <- fit[2,1]
na <- which(is.na(fit[,1]))
fit[,1][na] <- (fit[,1][na+1]+fit[,1][na-1])/2 # 上下平均值插补NA
print('行业指标的平稳性检验结果:')
print(adf.test(fit[,1]))
colnames(fit) <- c('index', 'growth')
return(fit)
}
df <- uniModel('ROE/采掘ROE.csv', indgrowth)
df <- uniModel('ROE/采掘ROE.csv', indgrowth)
df <- uniModel('ROE/传媒ROE.csv', indgrowth)
df <- uniModel('ROE/电器设备ROE.csv', indgrowth)
df <- uniModel('ROE/电气设备ROE.csv', indgrowth)
df <- uniModel('ROE/电子设备ROE.csv', indgrowth)
df <- uniModel('ROE/电子ROE.csv', indgrowth)
df <- uniModel('ROE/房地产ROE.csv', indgrowth)
df <- uniModel('ROE/纺织服装ROE.csv', indgrowth)
getIndex <- function(filename){
path <- paste('AshareIndustry/', filename, sep = '')
profit <- read.csv(path, header = T)
idx <- idxMedian(df = profit,
time_start = "1993/3/1",
time_end = "2017/12/1")
return(idx)
}
aa <- getIndex('ROE/钢铁ROE.csv')
View(aa)
log((aa[,1] - min(aa[,1]) + 1))
min(aa[,1])
log((aa[,1] - min(aa[,1], na.rm = T) + 1))
aa <- getIndex('ROE/钢铁ROE.csv')
a <- log((aa[,1] - min(aa[,1], na.rm = T) + 1))
adf.test(a)
diff(aa[,1])
adf.test(a)
ts.plot(a)
df <- uniModel('ROE/采掘ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
df <- uniModel('ROE/传媒ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
df <- uniModel('ROE/电气设备ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
df <- uniModel('ROE/电气设备ROE.csv', indgrowth)
df <- uniModel('ROE/电子ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
df <- uniModel('ROE/房地产ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
df <- uniModel('ROE/纺织服装ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
df <- uniModel('ROE/非银金融ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
df <- uniModel('ROE/钢铁ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
df <- uniModel('ROE/公用事业ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
df <- uniModel('ROE/国防军工ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
df <- uniModel('ROE/化工ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
df <- uniModel('ROE/机械设备ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
df <- uniModel('ROE/计算机ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
df <- uniModel('ROE/计算机ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
df <- uniModel('ROE/家用电器ROE.csv', indgrowth)
df <- uniModel('ROE/家用电器ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
df <- uniModel('ROE/建筑材料ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
df <- uniModel('ROE/建筑装饰ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
df <- uniModel('ROE/交通运输ROE.csv', indgrowth)
df <- uniModel('ROE/交通运输ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
df <- uniModel('ROE/农林渔牧ROE.csv', indgrowth)
df <- uniModel('ROE/农林牧渔ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
df <- uniModel('ROE/汽车ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
df <- uniModel('ROE/汽车ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
grangertest(growth~index, order = k)
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
df <- uniModel('ROE/轻工制造ROE.csv', indgrowth)
df <- uniModel('ROE/轻工制造ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
df <- uniModel('ROE/商业贸易ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
df <- uniModel('ROE/食品饮料ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
df <- uniModel('ROE/通信ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
df <- uniModel('ROE/休闲服务ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
df <- uniModel('ROE/休闲服务ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
df <- uniModel('ROE/医药生物ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
df <- uniModel('ROE/银行ROE.csv', indgrowth)
df <- uniModel('ROE/银行ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
k <- min(infocri)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
df <- uniModel('ROE/有色金属ROE.csv', indgrowth)
df <- uniModel('ROE/有色金属ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
df <- uniModel('ROE/综合ROE.csv', indgrowth)
m1 <- lm(index~growth, data = df)
summary(m1)
infocri <- unlist(VARselect(df, lag.max=12,type="const")["selection"])
k <- min(infocri)
k
index <- df[,1]
growth <- df[,2]
grangertest(growth~index, order = k)
grangertest(index~growth, order = k)
